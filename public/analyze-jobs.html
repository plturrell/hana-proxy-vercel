<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analyze - FinSight Intelligence</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://unpkg.com/@blueprintjs/core@4.20.2/lib/css/blueprint.css" rel="stylesheet">
  <link href="apple-hybrid-safe.css" rel="stylesheet">
  <style>
    /* Jobs/Ive Minimalist Design System */
    :root {
      --jobs-black: #000000;
      --jobs-white: #FFFFFF;
      --jobs-gray: #8E8E93;
      --jobs-light-gray: #F2F2F7;
      --jobs-blue: #007AFF;
      --jobs-green: #34C759;
      --jobs-red: #FF3B30;
      --jobs-orange: #FF9500;
      
      --jobs-font: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "Helvetica Neue", sans-serif;
      --jobs-font-size-hero: 48px;
      --jobs-font-size-title: 34px;
      --jobs-font-size-headline: 28px;
      --jobs-font-size-body: 17px;
      --jobs-font-size-caption: 13px;
      
      --jobs-spacing-xs: 4px;
      --jobs-spacing-sm: 8px;
      --jobs-spacing-md: 16px;
      --jobs-spacing-lg: 24px;
      --jobs-spacing-xl: 32px;
      --jobs-spacing-xxl: 48px;
      
      --jobs-animation: cubic-bezier(0.25, 0.46, 0.45, 0.94);
      --jobs-duration: 300ms;
    }
    
    * {
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    
    body {
      margin: 0;
      font-family: var(--jobs-font);
      font-size: var(--jobs-font-size-body);
      color: var(--jobs-black);
      background: var(--jobs-white);
      line-height: 1.47;
      overflow-x: hidden;
    }
    
    body.dark-mode {
      background: var(--jobs-black);
      color: var(--jobs-white);
    }
    
    body.dark-mode .jobs-card {
      background: #1C1C1E;
      border-color: #38383A;
    }
    
    body.dark-mode .jobs-section-nav {
      background: rgba(0, 0, 0, 0.9);
    }
    
    body.dark-mode .jobs-config-panel {
      background: rgba(28, 28, 30, 0.95);
      border-color: #38383A;
    }
    
    /* Navigation */
    .jobs-nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 48px;
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 var(--jobs-spacing-lg);
    }
    
    body.dark-mode .jobs-nav {
      background: rgba(0, 0, 0, 0.8);
      border-bottom-color: rgba(255, 255, 255, 0.1);
    }
    
    .jobs-nav-title {
      font-size: var(--jobs-font-size-body);
      font-weight: 600;
      letter-spacing: -0.01em;
    }
    
    .jobs-nav-actions {
      display: flex;
      gap: var(--jobs-spacing-md);
      align-items: center;
    }
    
    .jobs-nav-button {
      background: none;
      border: none;
      padding: var(--jobs-spacing-xs) var(--jobs-spacing-sm);
      font-size: var(--jobs-font-size-caption);
      color: var(--jobs-blue);
      cursor: pointer;
      border-radius: 6px;
      transition: all var(--jobs-duration) var(--jobs-animation);
    }
    
    .jobs-nav-button:hover {
      background: rgba(0, 122, 255, 0.1);
    }
    
    /* Section Navigation */
    .jobs-section-nav {
      position: fixed;
      top: 48px;
      left: 0;
      right: 0;
      height: 44px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-bottom: 0.5px solid rgba(0, 0, 0, 0.1);
      z-index: 999;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow-x: auto;
    }
    
    .jobs-section-tabs {
      display: flex;
      gap: var(--jobs-spacing-xl);
      padding: 0 var(--jobs-spacing-lg);
    }
    
    .jobs-section-tab {
      padding: var(--jobs-spacing-sm) 0;
      font-size: var(--jobs-font-size-body);
      font-weight: 500;
      color: var(--jobs-gray);
      cursor: pointer;
      border-bottom: 2px solid transparent;
      transition: all var(--jobs-duration) var(--jobs-animation);
      white-space: nowrap;
    }
    
    .jobs-section-tab.active {
      color: var(--jobs-blue);
      border-bottom-color: var(--jobs-blue);
    }
    
    /* Main Container */
    .jobs-container {
      padding-top: 92px;
      min-height: 100vh;
      padding-bottom: 100px;
    }
    
    /* Section */
    .jobs-section {
      display: none;
      padding: var(--jobs-spacing-lg);
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .jobs-section.active {
      display: block;
    }
    
    .jobs-section-header {
      text-align: center;
      margin-bottom: var(--jobs-spacing-xxl);
    }
    
    .jobs-section-title {
      font-size: var(--jobs-font-size-title);
      font-weight: 600;
      letter-spacing: -0.02em;
      margin: 0 0 var(--jobs-spacing-sm);
    }
    
    .jobs-section-subtitle {
      font-size: var(--jobs-font-size-body);
      color: var(--jobs-gray);
      margin: 0;
    }
    
    /* Cards */
    .jobs-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: var(--jobs-spacing-lg);
      margin-bottom: var(--jobs-spacing-xl);
    }
    
    .jobs-card {
      background: var(--jobs-white);
      border: 1px solid var(--jobs-light-gray);
      border-radius: 12px;
      padding: var(--jobs-spacing-lg);
      transition: all var(--jobs-duration) var(--jobs-animation);
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    
    .jobs-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }
    
    .jobs-card:active {
      transform: translateY(0);
    }
    
    .jobs-card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--jobs-spacing-md);
    }
    
    .jobs-card-title {
      font-size: var(--jobs-font-size-headline);
      font-weight: 600;
      margin: 0;
    }
    
    .jobs-card-action {
      font-size: var(--jobs-font-size-caption);
      color: var(--jobs-blue);
      text-decoration: none;
      padding: var(--jobs-spacing-xs) var(--jobs-spacing-sm);
      background: rgba(0, 122, 255, 0.1);
      border-radius: 6px;
      transition: all var(--jobs-duration) var(--jobs-animation);
    }
    
    .jobs-card-action:hover {
      background: rgba(0, 122, 255, 0.2);
    }
    
    .jobs-metric-value {
      font-size: var(--jobs-font-size-title);
      font-weight: 600;
      letter-spacing: -0.02em;
      margin: 0;
      line-height: 1.2;
    }
    
    .jobs-metric-label {
      font-size: var(--jobs-font-size-caption);
      color: var(--jobs-gray);
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: var(--jobs-spacing-sm);
    }
    
    .jobs-metric-change {
      font-size: var(--jobs-font-size-body);
      margin-top: var(--jobs-spacing-sm);
    }
    
    .jobs-metric-change.positive {
      color: var(--jobs-green);
    }
    
    .jobs-metric-change.negative {
      color: var(--jobs-red);
    }
    
    .jobs-metric-change.neutral {
      color: var(--jobs-gray);
    }
    
    /* Configuration Panel */
    .jobs-config-panel {
      position: fixed;
      top: 0;
      right: -400px;
      width: 400px;
      height: 100vh;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-left: 1px solid rgba(0, 0, 0, 0.1);
      z-index: 1001;
      padding: var(--jobs-spacing-xxl) var(--jobs-spacing-lg);
      transition: right var(--jobs-duration) var(--jobs-animation);
      overflow-y: auto;
    }
    
    .jobs-config-panel.active {
      right: 0;
    }
    
    .jobs-config-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--jobs-spacing-xl);
    }
    
    .jobs-config-title {
      font-size: var(--jobs-font-size-headline);
      font-weight: 600;
      margin: 0;
    }
    
    .jobs-config-close {
      background: none;
      border: none;
      font-size: 20px;
      cursor: pointer;
      color: var(--jobs-gray);
      padding: var(--jobs-spacing-xs);
      border-radius: 6px;
      transition: all var(--jobs-duration) var(--jobs-animation);
    }
    
    .jobs-config-close:hover {
      background: rgba(0, 0, 0, 0.1);
    }
    
    /* Chart placeholder */
    .jobs-chart {
      height: 200px;
      background: var(--jobs-light-gray);
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--jobs-gray);
      font-size: var(--jobs-font-size-body);
      margin: var(--jobs-spacing-lg) 0;
    }
    
    body.dark-mode .jobs-chart {
      background: #2C2C2E;
    }
    
    /* Holdings table */
    .jobs-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: var(--jobs-spacing-lg);
    }
    
    .jobs-table th,
    .jobs-table td {
      padding: var(--jobs-spacing-sm);
      text-align: left;
      border-bottom: 1px solid var(--jobs-light-gray);
    }
    
    body.dark-mode .jobs-table th,
    body.dark-mode .jobs-table td {
      border-bottom-color: #38383A;
    }
    
    .jobs-table th {
      font-weight: 600;
      font-size: var(--jobs-font-size-caption);
      color: var(--jobs-gray);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    /* Bottom Tab Bar */
    .jobs-tabbar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 49px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-top: 0.5px solid rgba(0, 0, 0, 0.1);
      display: flex;
      justify-content: space-around;
      align-items: center;
      z-index: 1000;
    }
    
    body.dark-mode .jobs-tabbar {
      background: rgba(0, 0, 0, 0.95);
      border-top-color: rgba(255, 255, 255, 0.1);
    }
    
    .jobs-tab {
      flex: 1;
      height: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--jobs-duration) var(--jobs-animation);
      text-decoration: none;
      color: var(--jobs-gray);
    }
    
    .jobs-tab:hover,
    .jobs-tab.active {
      color: var(--jobs-blue);
    }
    
    .jobs-tab-icon {
      font-size: 24px;
      margin-bottom: 2px;
    }
    
    .jobs-tab-label {
      font-size: 10px;
      font-weight: 500;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .jobs-grid {
        grid-template-columns: 1fr;
      }
      
      .jobs-config-panel {
        width: 100%;
        right: -100%;
      }
      
      .jobs-section-tabs {
        padding: 0 var(--jobs-spacing-md);
      }
    }
  </style>
</head>
<body class="dark-mode">
  <!-- Navigation -->
  <nav class="jobs-nav">
    <div class="jobs-nav-title">Analyze</div>
    <div class="jobs-nav-actions">
      <button class="jobs-nav-button" onclick="toggleDarkMode()">‚óê</button>
      <button class="jobs-nav-button" onclick="showSpotlight()">‚åòK</button>
    </div>
  </nav>
  
  <!-- Section Navigation -->
  <div class="jobs-section-nav">
    <div class="jobs-section-tabs">
      <div class="jobs-section-tab active" onclick="showSection('portfolio')">Portfolio</div>
      <div class="jobs-section-tab" onclick="showSection('treasury')">Treasury</div>
      <div class="jobs-section-tab" onclick="showSection('scenarios')">Scenarios</div>
      <div class="jobs-section-tab" onclick="showSection('calculations')">Calculations</div>
    </div>
  </div>
  
  <!-- Main Container -->
  <div class="jobs-container">
    <!-- Portfolio Section -->
    <div id="portfolio" class="jobs-section active">
      <div class="jobs-section-header">
        <h1 class="jobs-section-title">Portfolio Analysis</h1>
        <p class="jobs-section-subtitle">Advanced portfolio performance and risk analysis</p>
      </div>
      
      <div class="jobs-grid">
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Performance</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('portfolio-config')">Settings</a>
          </div>
          <div class="jobs-metric-label">Total Portfolio Value</div>
          <div class="jobs-metric-value">$24.8M</div>
          <div class="jobs-metric-change positive">‚Üó +5.2%</div>
          <div class="jobs-chart">Portfolio performance chart</div>
        </div>
        
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Risk Analysis</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('risk-config')">Settings</a>
          </div>
          <div class="jobs-metric-label">Sharpe Ratio</div>
          <div class="jobs-metric-value">1.82</div>
          <div class="jobs-metric-change positive">‚Üó +0.05</div>
          <div style="margin-top: 16px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">VaR (95%)</span>
              <span style="font-size: 13px;">-$2.1M</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Max Drawdown</span>
              <span style="font-size: 13px;">-3.2%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Beta</span>
              <span style="font-size: 13px;">1.15</span>
            </div>
          </div>
        </div>
        
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Top Holdings</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('holdings-config')">View All</a>
          </div>
          <table class="jobs-table">
            <thead>
              <tr>
                <th>Asset</th>
                <th>Weight</th>
                <th>Return</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>AAPL</td>
                <td>15.2%</td>
                <td style="color: var(--jobs-green);">+6.2%</td>
              </tr>
              <tr>
                <td>MSFT</td>
                <td>12.8%</td>
                <td style="color: var(--jobs-green);">+5.9%</td>
              </tr>
              <tr>
                <td>GOOGL</td>
                <td>10.5%</td>
                <td style="color: var(--jobs-red);">-4.7%</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
    
    <!-- Treasury Section -->
    <div id="treasury" class="jobs-section">
      <div class="jobs-section-header">
        <h1 class="jobs-section-title">Treasury Management</h1>
        <p class="jobs-section-subtitle">Real-time treasury management and cash flow analytics</p>
      </div>
      
      <div class="jobs-grid">
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Cash Position</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('treasury-config')">Optimize</a>
          </div>
          <div class="jobs-metric-label">Total Cash</div>
          <div class="jobs-metric-value">$25.0M</div>
          <div class="jobs-metric-change positive">‚Üó +4.1%</div>
          <div class="jobs-chart">Cash flow forecast</div>
        </div>
        
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Liquidity</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('liquidity-config')">Details</a>
          </div>
          <div class="jobs-metric-label">Coverage Ratio</div>
          <div class="jobs-metric-value">158%</div>
          <div class="jobs-metric-change positive">‚Üó All clear</div>
          <div style="margin-top: 16px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Short-term</span>
              <span style="font-size: 13px; color: var(--jobs-green);">158%</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Medium-term</span>
              <span style="font-size: 13px; color: var(--jobs-green);">112%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Long-term</span>
              <span style="font-size: 13px; color: var(--jobs-orange);">87%</span>
            </div>
          </div>
        </div>
        
        <div class="jobs-card">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Yield</h3>
            <a href="#" class="jobs-card-action" onclick="showConfig('yield-config')">Allocation</a>
          </div>
          <div class="jobs-metric-label">Weighted Average</div>
          <div class="jobs-metric-value">5.25%</div>
          <div class="jobs-metric-change positive">‚Üó +0.15%</div>
          <div style="margin-top: 16px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Money Market</span>
              <span style="font-size: 13px;">35%</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Treasury Bills</span>
              <span style="font-size: 13px;">25%</span>
            </div>
            <div style="display: flex; justify-content: space-between;">
              <span style="font-size: 13px; color: var(--jobs-gray);">Corporate Bonds</span>
              <span style="font-size: 13px;">20%</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Scenarios Section -->
    <div id="scenarios" class="jobs-section">
      <div class="jobs-section-header">
        <h1 class="jobs-section-title">Scenario Analysis</h1>
        <p class="jobs-section-subtitle">Monte Carlo Tree Search for advanced scenario modeling</p>
      </div>
      
      <div class="jobs-grid">
        <div class="jobs-card" onclick="runScenario('market-crash')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">üìâ Market Crash</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('scenario-config')">Configure</a>
          </div>
          <div class="jobs-metric-label">Expected Impact</div>
          <div class="jobs-metric-value">-18.3%</div>
          <div class="jobs-metric-change negative">‚Üò High risk</div>
        </div>
        
        <div class="jobs-card" onclick="runScenario('rate-hike')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">üìà Rate Hike</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('scenario-config')">Configure</a>
          </div>
          <div class="jobs-metric-label">Expected Impact</div>
          <div class="jobs-metric-value">-12.1%</div>
          <div class="jobs-metric-change negative">‚Üò Moderate risk</div>
        </div>
        
        <div class="jobs-card" onclick="runScenario('volatility-spike')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">‚ö° Volatility Spike</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('scenario-config')">Configure</a>
          </div>
          <div class="jobs-metric-label">Expected Impact</div>
          <div class="jobs-metric-value">¬±28.9%</div>
          <div class="jobs-metric-change neutral">‚Üî High variance</div>
        </div>
      </div>
    </div>
    
    <!-- Calculations Section -->
    <div id="calculations" class="jobs-section">
      <div class="jobs-section-header">
        <h1 class="jobs-section-title">Financial Calculations</h1>
        <p class="jobs-section-subtitle">Test and validate financial calculations in real-time</p>
      </div>
      
      <div class="jobs-grid">
        <div class="jobs-card" onclick="testCalculation('var')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Value at Risk</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('calc-config')">Test</a>
          </div>
          <div class="jobs-metric-label">95% Confidence</div>
          <div class="jobs-metric-value">-2.1%</div>
          <div class="jobs-metric-change negative">‚Üò Risk measure</div>
        </div>
        
        <div class="jobs-card" onclick="testCalculation('black-scholes')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Black-Scholes</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('calc-config')">Test</a>
          </div>
          <div class="jobs-metric-label">Call Option</div>
          <div class="jobs-metric-value">$8.42</div>
          <div class="jobs-metric-change positive">‚Üó Fair value</div>
        </div>
        
        <div class="jobs-card" onclick="testCalculation('sharpe')">
          <div class="jobs-card-header">
            <h3 class="jobs-card-title">Sharpe Ratio</h3>
            <a href="#" class="jobs-card-action" onclick="event.stopPropagation(); showConfig('calc-config')">Test</a>
          </div>
          <div class="jobs-metric-label">Risk-Adjusted Return</div>
          <div class="jobs-metric-value">1.82</div>
          <div class="jobs-metric-change positive">‚Üó Good performance</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Configuration Panel -->
  <div id="configPanel" class="jobs-config-panel">
    <div class="jobs-config-header">
      <h2 class="jobs-config-title" id="configTitle">Configuration</h2>
      <button class="jobs-config-close" onclick="closeConfig()">√ó</button>
    </div>
    <div id="configContent">
      <!-- Configuration content will be loaded here -->
    </div>
  </div>
  
  <!-- Bottom Tab Bar -->
  <div class="jobs-tabbar">
    <a href="/index-jobs.html" class="jobs-tab">
      <div class="jobs-tab-icon">‚óâ</div>
      <div class="jobs-tab-label">Today</div>
    </a>
    <a href="#" class="jobs-tab active">
      <div class="jobs-tab-icon">‚óé</div>
      <div class="jobs-tab-label">Analyze</div>
    </a>
    <a href="/control-jobs.html" class="jobs-tab" id="control-tab" style="display: none;">
      <div class="jobs-tab-icon">‚óà</div>
      <div class="jobs-tab-label">Control</div>
    </a>
    <a href="/model-jobs.html" class="jobs-tab">
      <div class="jobs-tab-icon">‚óÜ</div>
      <div class="jobs-tab-label">Model</div>
    </a>
    <a href="/teach-jobs.html" class="jobs-tab">
      <div class="jobs-tab-icon">‚óá</div>
      <div class="jobs-tab-label">Teach</div>
    </a>
    <a href="/ai-jobs.html" class="jobs-tab">
      <div class="jobs-tab-icon">‚óà</div>
      <div class="jobs-tab-label">AI</div>
    </a>
  </div>
  
  <script>
    // Check user role
    const userRole = localStorage.getItem('userRole') || 'Finance';
    if (userRole === 'Technology') {
      document.getElementById('control-tab').style.display = 'flex';
    }
    
    // Section navigation
    function showSection(sectionId) {
      // Hide all sections
      document.querySelectorAll('.jobs-section').forEach(section => {
        section.classList.remove('active');
      });
      
      // Remove active from all tabs
      document.querySelectorAll('.jobs-section-tab').forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected section
      document.getElementById(sectionId).classList.add('active');
      
      // Activate tab
      event.target.classList.add('active');
      
      // Update URL hash
      window.location.hash = sectionId;
    }
    
    // Configuration panel
    function showConfig(configType) {
      const panel = document.getElementById('configPanel');
      const title = document.getElementById('configTitle');
      const content = document.getElementById('configContent');
      
      // Set title based on config type
      const configTitles = {
        'portfolio-config': 'Portfolio Settings',
        'risk-config': 'Risk Parameters',
        'treasury-config': 'Treasury Optimization',
        'scenario-config': 'Scenario Parameters',
        'calc-config': 'Calculation Settings'
      };
      
      title.textContent = configTitles[configType] || 'Configuration';
      
      // Load configuration content
      content.innerHTML = getConfigContent(configType);
      
      // Show panel
      panel.classList.add('active');
    }
    
    function closeConfig() {
      document.getElementById('configPanel').classList.remove('active');
    }
    
    function getConfigContent(configType) {
      const configs = {
        'portfolio-config': `
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Benchmark</label>
            <select style="width: 100%; padding: 8px; border: 1px solid var(--jobs-light-gray); border-radius: 6px;">
              <option>S&P 500</option>
              <option>NASDAQ</option>
              <option>Custom</option>
            </select>
          </div>
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Rebalancing</label>
            <select style="width: 100%; padding: 8px; border: 1px solid var(--jobs-light-gray); border-radius: 6px;">
              <option>Monthly</option>
              <option>Quarterly</option>
              <option>Annually</option>
            </select>
          </div>
          <button style="width: 100%; padding: 12px; background: var(--jobs-blue); color: white; border: none; border-radius: 6px; cursor: pointer;">Apply Settings</button>
        `,
        'risk-config': `
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Risk Tolerance</label>
            <input type="range" min="1" max="10" value="5" style="width: 100%;">
            <div style="display: flex; justify-content: space-between; font-size: 12px; color: var(--jobs-gray);">
              <span>Conservative</span>
              <span>Aggressive</span>
            </div>
          </div>
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">VaR Confidence Level</label>
            <select style="width: 100%; padding: 8px; border: 1px solid var(--jobs-light-gray); border-radius: 6px;">
              <option>95%</option>
              <option>99%</option>
              <option>99.9%</option>
            </select>
          </div>
          <button style="width: 100%; padding: 12px; background: var(--jobs-blue); color: white; border: none; border-radius: 6px; cursor: pointer;">Update Risk Parameters</button>
        `,
        'treasury-config': `
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Target Yield</label>
            <input type="number" step="0.1" value="5.25" style="width: 100%; padding: 8px; border: 1px solid var(--jobs-light-gray); border-radius: 6px;">
            <div style="font-size: 12px; color: var(--jobs-gray); margin-top: 4px;">Current: 5.25%</div>
          </div>
          <div style="margin-bottom: 24px;">
            <label style="display: block; margin-bottom: 8px; font-weight: 600;">Liquidity Buffer</label>
            <input type="number" step="0.1" value="10" style="width: 100%; padding: 8px; border: 1px solid var(--jobs-light-gray); border-radius: 6px;">
            <div style="font-size: 12px; color: var(--jobs-gray); margin-top: 4px;">Percentage of total cash</div>
          </div>
          <button style="width: 100%; padding: 12px; background: var(--jobs-blue); color: white; border: none; border-radius: 6px; cursor: pointer;">Optimize Allocation</button>
        `
      };
      
      return configs[configType] || '<p>Configuration options will appear here.</p>';
    }
    
    // Test calculation
    function testCalculation(type) {
      alert(`Testing ${type} calculation...`);
    }
    
    // Run scenario
    function runScenario(type) {
      alert(`Running ${type} scenario analysis...`);
    }
    
    // Dark mode toggle
    function toggleDarkMode() {
      document.body.classList.toggle('dark-mode');
      localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
    }
    
    // Spotlight search
    function showSpotlight() {
      const query = prompt('Search FinSight...');
      if (query) {
        console.log('Searching for:', query);
      }
    }
    
    // Load saved preferences
    if (localStorage.getItem('darkMode') === 'false') {
      document.body.classList.remove('dark-mode');
    }
    
    // Handle URL hash
    if (window.location.hash) {
      const section = window.location.hash.substring(1);
      const tab = document.querySelector(`[onclick="showSection('${section}')"]`);
      if (tab) {
        tab.click();
      }
    }
    
    // Touch gestures for section switching
    let touchStartX = 0;
    let touchStartY = 0;
    
    document.addEventListener('touchstart', (e) => {
      touchStartX = e.touches[0].clientX;
      touchStartY = e.touches[0].clientY;
    });
    
    document.addEventListener('touchend', (e) => {
      const touchEndX = e.changedTouches[0].clientX;
      const touchEndY = e.changedTouches[0].clientY;
      const diffX = touchStartX - touchEndX;
      const diffY = touchStartY - touchEndY;
      
      // Only handle horizontal swipes
      if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 50) {
        const sections = ['portfolio', 'treasury', 'scenarios', 'calculations'];
        const currentSection = document.querySelector('.jobs-section.active').id;
        const currentIndex = sections.indexOf(currentSection);
        
        if (diffX > 0 && currentIndex < sections.length - 1) {
          // Swipe left - next section
          document.querySelector(`[onclick="showSection('${sections[currentIndex + 1]}')"]`).click();
        } else if (diffX < 0 && currentIndex > 0) {
          // Swipe right - previous section
          document.querySelector(`[onclick="showSection('${sections[currentIndex - 1]}')"]`).click();
        }
      }
    });
    
    // Close config panel when clicking outside
    document.addEventListener('click', (e) => {
      const panel = document.getElementById('configPanel');
      const configActions = document.querySelectorAll('.jobs-card-action');
      
      if (panel.classList.contains('active') && 
          !panel.contains(e.target) && 
          !Array.from(configActions).some(action => action.contains(e.target))) {
        closeConfig();
      }
    });
  </script>
</body>
</html>